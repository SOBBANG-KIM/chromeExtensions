<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Today Snippet</title>
  <link rel="stylesheet" href="./sidepanel.css" />
</head>
<body>
  <header class="top">

    <div class="row headerRow">
      <div class="searchWrap">
        <input id="q" class="search" placeholder="Search" />
        <button id="clearQ" class="iconBtn" title="Clear" aria-label="Clear Search">×</button>
      </div>
      <button id="refreshContext" class="btn icon-btn" title="Refresh">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
          <path d="M21 3v5h-5"></path>
          <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
          <path d="M3 21v-5h5"></path>
        </svg>
      </button>
      <select id="theme" class="select" title="Theme">
        <option value="dark">Dark</option>
        <option value="light">Light</option>
        <option value="purple">Purple</option>
        <option value="blue">Blue</option>
        <option value="teal">Teal</option>
        <option value="green">Green</option>
        <option value="orange">Orange</option>
        <option value="pink">Pink</option>
        <option value="magenta">Magenta</option>
      </select>
    </div>

    <div class="row">
      <button id="new" class="btn primary">+ New Snippet</button>
      <button id="openVariables" class="btn">+ Add Variables</button>
    </div>

  </header>

  <main class="main">
    <div id="list" class="list"></div>
  </main>

  <div id="modal" class="modal" style="display:none;">
    <div class="modalBackdrop"></div>
    <div class="modalCard" role="dialog" aria-modal="true">
      <div class="modalTitle">필수 변수 입력</div>
      <div class="modalDesc">아래 값을 채우면 문구에 자동으로 들어가요. (Ctrl/Cmd+Enter = 삽입)</div>
      <div id="varFields" class="varFields"></div>
      <div class="modalActions">
        <button id="modalCancel" class="btn">Cancel</button>
        <button id="modalOk" class="btn primary">Insert</button>
      </div>
    </div>
  </div>

  <div id="editorModal" class="modal" style="display:none;">
    <div id="editorBackdrop" class="modalBackdrop"></div>
    <div class="modalCard editorModalCard" role="dialog" aria-modal="true">
      <div class="modalHeader">
        <div class="modalTitle">Snippet</div>
        <button id="editorClose" class="modalClose" type="button" aria-label="Close">×</button>
      </div>

      <div class="form">
        <label class="label">제목(title)</label>
        <input id="title" class="input" />

        <label class="label">본문(content)</label>
        <textarea id="content" class="textarea" rows="5"
          placeholder="예) 안녕하세요 {{name}}님,&#10;요청하신 내용 확인했습니다.&#10;{{date}} 기준으로 안내드립니다."></textarea>

        <div class="actions">
          <button id="save" class="btn">Create</button>
        </div>

        <div class="help">
          <div class="helpTitle">미리보기(결과)</div>
          <pre id="preview" class="previewBox"></pre>
          <div class="helpTitle">변수</div>
          내장: <code>{{date}}</code> <code>{{time}}</code> <code>{{datetime}}</code> <code>{{clipboard}}</code>
          <code>{{selectedText}}</code> <code>{{url}}</code> <code>{{title}}</code> <code>{{hostname}}</code><br/>
          사용자 변수: 아래 “변수 관리”에 등록한 값도 바로 치환됩니다.
        </div>
      </div>
    </div>
  </div>

  <div id="variablesModal" class="modal" style="display:none;">
    <div id="variablesBackdrop" class="modalBackdrop"></div>
    <div class="modalCard variablesModalCard" role="dialog" aria-modal="true">
      <div class="modalHeader">
        <div class="modalTitle">Variables</div>
        <button id="variablesClose" class="modalClose" type="button" aria-label="Close">×</button>
      </div>

      <div class="form">
        <div class="varsHint">
          변수는 <code>{{variable_name}}</code> 형태로 본문에 넣을 수 있어요. <br/>
          <b>영문/숫자/언더스코어</b>만 권장합니다.<br/><br/>
          예) <code>{{name}}</code>, <code>{{phone_number}}</code><br/><br/>
          <div id="builtinVarsBlock">
            내장 변수(등록 불필요): <br/>
            <div id="builtinVarsList"></div>
          </div>
        </div>

        <div class="row" style="margin-bottom: 0;">
          <input id="varKey" class="input" placeholder="key ex) name" />
          <input id="varValue" class="input" placeholder="value ex) 김철수" />
        </div>

        <div class="actions">
          <button id="addVar" class="btn">Create</button>
        </div>

        <div id="varList" class="varList"></div>
      </div>
    </div>
  </div>

  <input id="filePicker" type="file" accept="application/json" style="display:none;" />
  <script type="module" src="./sidepanel.js"></script>
</body>
</html>
